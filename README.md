![License: CISCO](https://img.shields.io/badge/License-CISCO-blue.svg)
[![published](https://static.production.devnetcloud.com/codeexchange/assets/images/devnet-published.svg)](https://developer.cisco.com/codeexchange/github/repo/chrivand/action-kenna-cve-exploits-js)

# Cisco Kenna: Check CVE for Malware Exploits [DRAFT]

> **Note:** please test this well before using in production, this is a sample action! The action itself should work, however it depends on how you wish to trigger it as you need a CVE-ID to make this action useful.

This **GitHub Action** check a **CVE** security alert (e.g. from **Dependabot**) for known malware exploits using the **[Kenna Security VI+ API](https://apidocs.kennasecurity.com/reference/show-malware-hashes-1)** and a **NodeJS GitHub Action**.

## Usage

1. Set the Kenna Security API Key (`KENNA_API_KEY`) as repository secrets in the repository that you want to run the action in. The CVE ID will be parsed automatically from the GitHub alert.

![](screenshots/repo_secret.png)

2. Create a file called `kenna_cve_check.yml` with the following content in the `.github/workflows` directory of your repository from where you want to run the action:

```yml
name: Check CVE with Kenna VI+ API JS Action

on: 
  pull_request:

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  dependabot:
    runs-on: ubuntu-latest
    if: ${{ github.actor == 'dependabot[bot]' }}
    steps:
      - name: Dependabot fetch metadata
        id: metadata
        uses: dependabot/fetch-metadata@v1.3.1
        with:
          alert-lookup: true
          compat-lookup: true
          github-token: "${{ secrets.GITHUB_TOKEN }}"
      - run: echo ${{ steps.dependabot-metadata.outputs }}

  kenna_vi_api_call:
    runs-on: ubuntu-latest
    name: CVE Check for Malware Exploits with Kenna VI+ API
    steps:
      - name: GET Request Kenna VI+ API
        uses: chrivand/action-webex-js@main
        env:
          KENNA_API_KEY: ${{ secrets.KENNA_API_KEY }}
          CVE_ID: "${{ steps.dependabot-metadata.outputs.external-id }}"
```

3. Adjust the `yml` file as needed, **especially the `CVE_ID` environment variable**. You can for example trigger this based on security alerts or based on certain output of other actions that you have run before. This does **NOT** have to be Dependabot, it can also be a different (SAST) solution that produces a CVE-ID as output. Please check the [GitHub documentation](https://docs.github.com/en/actions/learn-github-actions/contexts) for all context that you can use.
