const axios = require('axios');
const core = require('@actions/core');
const github = require('@actions/github');

var KENNA_API_KEY = process.env.KENNA_API_KEY;
var CVE_ID = process.env.CVE_ID;

var REQUEST_URL = 'https://api.kennasecurity.com/vulnerability_definitions/' + CVE_ID + 'malware';

var config = {
  method: 'get',
  url:  REQUEST_URL,
  headers: { 
    'X-Risk-Token': KENNA_API_KEY, 
    'Accept': 'application/json'
  }
};

axios(config)
.then(function (response) {
  returned_kenna_data = JSON.stringify(response.data);
  core.setOutput("returned_kenna_data", returned_kenna_data);
  console.log(returned_kenna_data);
})
.catch(function (error) {
  console.log(error);
});
